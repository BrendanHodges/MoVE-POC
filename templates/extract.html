<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MoVE | Data Extraction</title>

  <!-- reuse your dashboard styling -->
  <link rel="stylesheet" href="/static/css/site.css" />
</head>

<body>
  <main class="container" style="padding-top: 18px; padding-bottom: 24px;">
    <!-- Header -->
    <div class="dashboard-header" style="margin-bottom: 10px;">
      <h2 style="margin: 0;">Data Extraction</h2>
      <p style="margin: 6px 0 0 0; color: var(--muted);">
        Select a geography, choose variables, preview results, then export as CSV or JSON.
      </p>
    </div>

    <!-- Layout: left filters / right preview -->
    <div id="extractor-layout" style="display: flex; gap: 12px;">
      <!-- LEFT: Filters -->
      <aside id="extractor-filters"
             style="width: 360px; border: 1px solid var(--border); padding: 12px; overflow-y: auto;">

        <h3 style="margin-top: 0;">1) Geography</h3>

          <div style="margin-bottom: 10px;">
            <div style="font-size: 0.9rem; margin-bottom: 6px; color: var(--muted);">
              Export level
            </div>

            <label style="display:flex; gap:8px; align-items:center; margin-bottom:6px;">
              <input type="radio" name="geo_level" value="state" checked />
              Export entire state
            </label>

            <label style="display:flex; gap:8px; align-items:center;">
              <input type="radio" name="geo_level" value="county" />
              Export single county
            </label>
          </div>

          <label for="stateInput" style="display:block; font-size:0.9rem; margin-bottom:6px;">
            State (name or abbreviation)
          </label>
          <input
            id="stateInput"
            type="text"
            placeholder="e.g. Maryland or MD"
            style="width:100%; padding:6px 8px; border:1px solid var(--border); font-family:inherit;"
          />

          <div style="margin:10px 0;">
            <label for="countyInput" style="display:block; font-size:0.9rem; margin-bottom:6px;">
              County ID
            </label>
            <input
              id="countyInput"
              type="text"
              placeholder="e.g. 24005"
              disabled
              style="width:100%; padding:6px 8px; border:1px solid var(--border); font-family:inherit;"
            />
          </div>

          <div style="font-size:0.85rem; color:var(--muted);">
            Use county ID only when exporting a single county.
          </div>


        <hr style="border: none; border-top: 1px solid var(--border); margin: 14px 0;">

        <h3 style="margin: 0 0 10px 0;">2) Include MoVE Score</h3>
        <label style="display: flex; gap: 8px; align-items: center;">
          <input type="checkbox" id="includeMoveScore" checked />
          Include MoVE score in extraction
        </label>

        <hr style="border: none; border-top: 1px solid var(--border); margin: 14px 0;">

        <h3 style="margin: 0 0 10px 0;">3) Variables</h3>

        <!-- Variable Type A -->
        <fieldset style="border: 1px solid var(--border); padding: 10px; margin: 0 0 10px 0;" data-vartype ="county">
          <legend style="padding: 0 6px; color: var(--muted); font-size: 0.9rem;">
            MoVE County Level Variable's
          </legend>

          <label for="CountyVar" style="display:block; font-size:0.9rem; margin-bottom:6px;">
            Select variable
          </label>
          <select id="CountyVar" class="county-dropdown">
            <option value="">Choose a variable...</option>
            <option value="v1_example_1">Example V1 - Option 1</option>
            <option value="v1_example_2">Example V1 - Option 2</option>
          </select>

          <button type="button" class="tab-button add-var-btn" style="margin-top: 8px;">
            Add Variable
          </button>
        </fieldset>

        <!-- Variable Type B -->
        <fieldset style="border: 1px solid var(--border); padding: 10px; margin: 0 0 10px 0;" data-vartype ="state">
          <legend style="padding: 0 6px; color: var(--muted); font-size: 0.9rem;">
            MoVE State Level Variable's
          </legend>

          <label for="StateVar" style="display:block; font-size:0.9rem; margin-bottom:6px;">
            Select variable
          </label>
          <select id="StateVar" class="county-dropdown">
            <option value="">Choose a variable...</option>
            <option value="v2_example_1">Example V2 - Option 1</option>
            <option value="v2_example_2">Example V2 - Option 2</option>
          </select>

          <button type="button" class="tab-button add-var-btn" style="margin-top: 8px;">
            Add Variable
          </button>
        </fieldset>

        <!-- Variable Type C -->
        <fieldset style="border: 1px solid var(--border); padding: 10px; margin: 0;" data-vartype ="census">
          <legend style="padding: 0 6px; color: var(--muted); font-size: 0.9rem;">
            U.S Census Variable's 
          </legend>

          <label for="CensusVar" style="display:block; font-size:0.9rem; margin-bottom:6px;">
            Select variable
          </label>
          <select id="CensusVar" class="county-dropdown">
            <option value="">Choose a variable...</option>
            <option value="v3_example_1">Example V3 - Option 1</option>
            <option value="v3_example_2">Example V3 - Option 2</option>
          </select>

          <button type="button" class="tab-button add-var-btn" style="margin-top: 8px;">
            Add Variable
          </button>
        </fieldset>

        <hr style="border: none; border-top: 1px solid var(--border); margin: 14px 0;">

        <h3 style="margin: 0 0 10px 0;">4) Actions</h3>

        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
          <button type="button" class="tab-button" id="previewBtn">Preview</button>
          <button type="button" class="tab-button" id="clearBtn">Clear</button>
        </div>

        <div style="margin-top: 10px; display: flex; gap: 8px; flex-wrap: wrap;">
          <button type="button" class="tab-button" id="exportCsvBtn">Export CSV</button>
          <button type="button" class="tab-button" id="exportJsonBtn">Export JSON</button>
        </div>

        <p style="margin-top: 10px; font-size: 0.85rem; color: var(--muted);">
          Preview generates a sample table so you can confirm selections before exporting.
        </p>
      </aside>

      <!-- RIGHT: Selected variables + preview -->
      <section id="extractor-preview"
               style="flex: 1; border: 1px solid var(--border); padding: 12px; min-height: 560px;">

        <!-- Selected variables summary -->
        <div style="display: flex; align-items: baseline; justify-content: space-between; gap: 12px; flex-wrap: wrap;">
          <h3 style="margin: 0;">Selected Variables</h3>
          <div style="color: var(--muted); font-size: 0.9rem;">
            <span id="selected-count">0</span> selected
          </div>
        </div>

        <div id="selected-variables"
             style="margin-top: 10px; border: 1px dashed var(--border); padding: 10px; min-height: 56px;">
          <!-- filled later -->
          <span style="color: var(--muted); font-size: 0.9rem;">
            No variables selected yet. Use the “Add Variable” buttons on the left.
          </span>
        </div>

        <hr style="border: none; border-top: 1px solid var(--border); margin: 14px 0;">

        <!-- Preview table -->
        <div style="display: flex; align-items: baseline; justify-content: space-between; gap: 12px; flex-wrap: wrap;">
          <h3 style="margin: 0;">Preview Table</h3>
          <div style="color: var(--muted); font-size: 0.9rem;">
            Showing up to <span id="preview-limit">100</span> rows
          </div>
        </div>

        <p style="margin: 8px 0 12px 0; color: var(--muted); font-size: 0.9rem;">
          Preview is for confirmation only. Exports may include more rows depending on your selection.
        </p>

        <div id="preview-table" style="overflow: auto; border: 1px solid var(--border);">
          <table style="width: 100%; border-collapse: collapse; font-size: 0.92rem;">
            <thead>
              <tr>
                <th style="text-align:left; padding:8px; border-bottom:1px solid var(--border);">Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="padding: 8px; color: var(--muted);">
                  Click “Preview” to load sample rows based on your selections.
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Optional footer area for messages -->
        <div id="extractor-messages" style="margin-top: 10px; color: var(--muted); font-size: 0.9rem;">
          <!-- used for validation/errors later -->
        </div>
      </section>
    </div>
  </main>

  <script src="/static/js/extract.js"></script>
  
</body>
</html>
